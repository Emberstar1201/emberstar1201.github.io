# 维度添加指南

## 概述

本指南将帮助开发者了解如何在 Emberstar 项目中添加新的维度内容。Emberstar 使用统一的内容渲染系统，支持多种类型的内容展示。

## 维度系统架构

### 文件位置
- **维度数据**: `src/services/dimensionService.js`
- **渲染组件**: `src/components/renderers/`
- **主渲染器**: `src/components/DimensionContentRenderer.vue`

### 权限系统
每个维度都有对应的权限等级要求：

```javascript
this.dimensionPermissions = {
  "pureland": 7,    // 余烬净土
  "cycle": 7,       // 循环维度  
  "void": 6,        // 虚空维度
  "dream": 6,       // 梦境维度
  "your_dimension": X // 你的维度权限等级 (1-7)
};
```

## 添加新维度步骤

### 1. 在 dimensionService.js 中添加维度定义

在 `dimensions` 对象中添加你的维度：

```javascript
your_dimension: {
  id: "your_dimension",
  name: "你的维度名称",
  content: {
    sections: [
      // 章节内容...
    ]
  }
}
```

### 2. 设置权限等级

在 `dimensionPermissions` 对象中添加权限设置：

```javascript
this.dimensionPermissions = {
  // 现有维度...
  "your_dimension": 5  // 设置权限等级 (1-7)
};
```

## 内容结构详解

### 基本章节结构

```javascript
{
  title: "章节标题",
  content: [
    // 内容项数组...
  ],
  quote: {  // 可选的章节引用
    text: "引用文本",
    author: "引用作者"
  }
}
```

## 可用内容类型

### 1. 段落 (paragraph)

```javascript
{
  type: "paragraph",
  text: "段落内容文本",
  highlights: ["需要高亮的关键词"]
}
```

### 2. 列表 (list)

```javascript
{
  type: "list",
  items: [
    {
      text: "列表项文本",
      highlights: ["高亮词"]
    },
    "纯文本列表项"
  ]
}
```

### 3. 有序列表 (numberedList)

```javascript
{
  type: "numberedList", 
  items: [
    "第一项",
    "第二项",
    "第三项"
  ]
}
```

### 4. 嵌套列表 (nestedList)

```javascript
{
  type: "nestedList",
  items: [
    {
      text: "主项目",
      subItems: [
        "子项目 1",
        "子项目 2"
      ]
    }
  ]
}
```

### 5. 结构化内容 (structuredContent) ⭐ 推荐

这是最灵活的内容类型，支持多种样式：

#### 5.1 梦幻记录风格 (dream-record)

```javascript
{
  type: "structuredContent",
  style: "dream-record",
  subtitle: "角色名称或标题",
  highlights: ["高亮内容"],
  items: [
    {
      label: "标签：",
      value: "内容值"
    },
    {
      text: "纯文本内容"
    }
  ]
}
```

#### 5.2 现象描述风格 (phenomenon)

```javascript
{
  type: "structuredContent",
  style: "phenomenon", 
  items: [
    {
      label: "代号：",
      value: "现象代号"
    },
    {
      label: "描述：",
      value: "现象描述",
      subItems: [
        "子项目 1",
        "子项目 2",
        { text: "警告项", type: "warning" }
      ]
    }
  ]
}
```

#### 5.3 灵魂流程风格 (soul-flow)

```javascript
{
  type: "structuredContent",
  style: "soul-flow",
  title: "标题文本",
  highlights: ["高亮标题"],
  items: [
    {
      text: "第一段内容"
    },
    {
      text: "第二段内容"
    }
  ]
}
```

#### 5.4 自定义风格

你可以创建自己的风格，只需在 `StructuredContentRenderer.vue` 中添加对应的 CSS 类：

```css
.structured-content.your-style {
  border: 1px dashed var(--your-color);
  background: rgba(your-rgb-values);
}
```

### 6. 日志 (log)

```javascript
{
  type: "log",
  items: [
    {
      label: "时间：",
      value: "2024-01-01 12:00:00"
    },
    {
      label: "事件：", 
      value: "事件描述",
      highlights: ["重要信息"]
    }
  ]
}
```

### 7. 引用 (quote)

```javascript
{
  type: "quote",
  text: "引用文本内容",
  author: "作者名称",
  highlights: ["高亮词"]
}
```

### 8. 子章节 (subsection)

```javascript
{
  type: "subsection",
  title: "子章节标题",
  content: [
    // 可以包含上述任何类型的内容
  ]
}
```

## 高亮系统

所有内容类型都支持 `highlights` 字段，用于高亮显示关键词：

```javascript
{
  type: "paragraph",
  text: "这是一个包含重要信息的段落",
  highlights: ["重要信息"]
}
```

## 警告样式

在结构化内容中，你可以使用警告样式：

```javascript
{
  type: "structuredContent",
  style: "phenomenon",
  items: [
    {
      label: "警告：",
      value: "",
      subItems: [
        { text: "这是警告信息", type: "warning" }
      ]
    }
  ]
}
```

## 完整示例

以下是一个完整的维度定义示例：

```javascript
new_dimension: {
  id: "new_dimension",
  name: "新维度",
  content: {
    sections: [
      {
        title: "第一章：概述",
        content: [
          {
            type: "paragraph",
            text: "这是新维度的概述介绍，包含重要信息。",
            highlights: ["重要信息"]
          },
          {
            type: "structuredContent",
            style: "phenomenon",
            items: [
              {
                label: "特性：",
                value: "维度的主要特性"
              }
            ]
          }
        ],
        quote: {
          text: "这是一段引用文本",
          author: "作者名"
        }
      },
      {
        title: "第二章：详细说明",
        content: [
          {
            type: "structuredContent",
            style: "dream-record",
            subtitle: "角色记录",
            items: [
              {
                label: "观察：",
                value: "观察到的情况"
              }
            ]
          },
          {
            type: "log",
            items: [
              {
                label: "时间：",
                value: "2024-01-01"
              }
            ]
          }
        ]
      }
    ]
  }
}
```

## 最佳实践

### 1. 命名规范
- 维度 ID 使用小写字母和下划线：`your_dimension`
- 章节标题使用中文：`"第一章：概述"`
- 内容保持简洁明了

### 2. 内容组织
- 按逻辑分章节组织内容
- 每个章节不宜过长
- 合理使用高亮和引用

### 3. 样式选择
- `dream-record`: 适合角色记录、梦境描述
- `phenomenon`: 适合现象分析、技术说明
- `soul-flow`: 适合流程说明、步骤描述
- 自定义样式：根据需要创建

### 4. 性能考虑
- 避免过深的嵌套结构
- 合理控制内容长度
- 使用高亮而不是大量格式化

## 测试验证

添加完维度后，请进行以下验证：

1. **构建测试**：确保 `npm run build` 成功
2. **功能测试**：在开发环境中测试新维度显示
3. **权限测试**：验证权限等级设置正确

## 常见问题

### Q: 如何添加新的样式风格？
A: 在 `StructuredContentRenderer.vue` 中添加新的 CSS 类，然后在数据中使用 `style: "your-style"`

### Q: 高亮文本不显示怎么办？
A: 检查 `highlights` 数组中的文本是否与 `text` 中的内容完全匹配

### Q: 权限等级如何设置？
A: 1-7 的数字等级，数字越大权限要求越高

### Q: 如何显示警告信息？
A: 使用 `{ text: "警告内容", type: "warning" }` 格式

## 技术支持

如有问题，请参考：
- 现有维度实现（pureland、cycle、void、dream）
- 组件源码：`src/components/renderers/`
- 样式文件：各渲染器组件的 `<style>` 部分

---

*最后更新：2024年1月*